#!/usr/bin/env bash

# TODO: Fix search problem

# This is the entry of rofi trans-shell
# This script require trans-shell itself, if you don't have one.
# You can install it from your package manager(if provided) or from source(clone trans-shell from github)

function Default_Configs {
    # The default translator for translate-shell
    export primary_translator="google"
    # The alternative transltor for translate-shell
    export secondary_translator="bing"

    export transHistory="$HOME/.rofi_trans"
    export transAudioCacheDir="$HOME/.rofi_trans_audio"
    export TARGET_LANG="zh-TW"
    export SOURCE_LANG=""
    export transTarget="zh-TW"          # deprecated, use TARGET_LANG instead
    export save_audio="save_audio"
    export transArgs="-b -speak"
    export verbose="1"
    export auto_refresh="1"
}
export version=1

if [ -z ${XDG_CONFIG_HOME+x} ]; then
    export XDG_CONFIG_HOME="$HOME/.config"
fi

# Setup environment variable for configs.
if [[ -f "$XDG_CONFIG_HOME/rofi_translate/rofi_translate.config" ]]; then
    source "$XDG_CONFIG_HOME/rofi_translate/rofi_translate.config" 
else
    Default_Configs
fi


if [[ -z "$default"     ]]; then default="brief"; fi
if [[ "$1" == "verbose" ]]; then default="verbose"; fi
if [[ "$1" == "brief"   ]]; then default="brief"; fi
if [[ "$1" == "delete"  ]]; then default="delete"; fi


rofi -sidebar-mode -modi "verbose:rofi_trans_verbose,brief:rofi_trans_brief,delete:rofi_trans_delete" -show "$default"
